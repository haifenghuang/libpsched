#!/bin/sh

if ! [ -e ".done" ]; then
	echo "Run 'do' first"
	exit 1
fi

if [ `id -u` -ne 0 ]; then
	echo "Current user is not root"
	exit 1
fi

if [ -e ./uconf/params/default/install ]; then
	while read cmd; do
		/bin/sh -c "${cmd}"

		if [ $? -ne 0 ]; then
			echo "Failed to execute: ${cmd}"
			exit 1
		fi
	done < ./uconf/params/default/install
fi

if [ -e ./uconf/params/`cat .osname 2> /dev/null`/install ]; then
	while read cmd; do
		/bin/sh -c "${cmd}"

		if [ $? -ne 0 ]; then
			echo "Failed to execute: ${cmd}"
			exit 1
		fi
	done < ./uconf/params/`cat .osname`/install
fi

echo "Installation complete."

exit 0

